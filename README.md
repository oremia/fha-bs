# FHA 结构化分析系统 (Web版) - 运行指南

这是一个基于 FastAPI (后端) 和 Vue.js (前端) 的全栈Web应用。请遵循以下步骤来设置和运行项目。

## **先决条件**

在开始之前，请确保您的系统上安装了以下软件：

* **Python 3.8+**
* **Node.js 16+** (包含 npm)
* **Vue CLI** (如果尚未安装，请运行 `npm install -g @vue/cli`)

## **项目结构**

请确保您的项目文件结构如下：

```
fha-web-app/
├── backend/
│   ├── main.py
│   └── requirements.txt
├── frontend/
│   ├── ... (所有Vue项目文件) ...
└── README.md
```

---

## **步骤 1: 设置并运行后端 (FastAPI)**

1.  **打开一个新的终端**，并导航到 `backend` 目录：
    ```bash
    cd path/to/fha-web-app/backend
    ```

2.  **(推荐) 创建并激活一个Python虚拟环境**：
    * 在 Windows 上:
        ```bash
        python -m venv venv
        .\venv\Scripts\activate
        ```
    * 在 macOS/Linux 上:
        ```bash
        python3 -m venv venv
        source venv/bin/activate
        ```

3.  **安装Python依赖项**：
    ```bash
    pip install -r requirements.txt
    ```

4.  **启动FastAPI服务器**：
    ```bash
    uvicorn main:app --reload
    ```
    * `--reload` 参数会在您修改代码后自动重启服务器，非常适合开发。

服务器现在应该在 `http://127.0.0.1:8000` 上运行。您可以在浏览器中访问 `http://127.0.0.1:8000/docs` 来查看自动生成的API文档。**请保持此终端窗口运行**。

---

## **步骤 2: 设置并运行前端 (Vue.js)**

1.  **打开另一个新的终端**，并导航到 `frontend` 目录：
    ```bash
    cd path/to/fha-web-app/frontend
    ```

2.  **安装npm依赖项**：
    ```bash
    npm install
    ```
    这可能需要几分钟时间。

3.  **启动Vue开发服务器**：
    ```bash
    npm run serve
    ```

4.  **访问应用**：
    终端会显示一个本地URL，通常是 `http://localhost:8080/`。在您的浏览器中打开此URL。

您现在应该能看到FHA系统的Web界面了。前端应用会自动连接到在 `http://127.0.0.1:8000` 运行的后端API。

---

## **步骤 3: 测试核心功能**

现在您可以开始测试应用的所有功能了：

1.  **新建项目**：
    * 点击 "新建分析项目"。
    * 在弹出的向导中，添加几个顶层功能和子功能。
    * 在右侧的矩阵中，为功能和飞行阶段的交叉点勾选复选框。
    * 点击 "确定创建"，您应该能在主表格中看到生成的待分析条目。

2.  **导入/导出**：
    * 点击 "导出为表格" 下载当前的FHA数据为Excel文件。
    * 修改Excel文件或使用一个旧格式的文件，然后通过 "导入旧格式表格" 按钮上传它，表格数据应该会更新。

3.  **添加/删除行**：
    * 点击 "添加行" 在表格末尾增加一个空行。
    * 选中几行，然后点击 "删除选中行" 来移除它们。

4.  **引导式分析**：
    * **选中表格中的一行** (确保只选一行)。
    * 点击 "引导式分析" 按钮。
    * 在向导的第一步，选择一个或多个失效模式，然后点击 "下一步"。
    * 为每个选择的失效模式填写影响描述，并不断点击 "下一步" 或 "上一步" 来切换。
    * 在最后一步，为每个失效模式评估危害等级。
    * 点击 "完成分析"。原始行将被替换为包含完整分析结果的新行。

5.  **风险摘要仪表盘**：
    * 切换到 "风险摘要" 标签页。
    * 您应该能看到更新后的KPI、风险分布旭日图和交叉分析矩阵。
    * 如果数据没有自动刷新，可以尝试切换回FHA总表再切换回来。

6.  **直接编辑**：
    * 在 "FHA 总表" 中，您可以直接在 "危害性分类" 列使用下拉菜单或在 "理由/备注" 列输入文本。修改会自动保存。

现在，您已经拥有了一个功能完整的、前后端分离的FHA分析系统！
